"use client";

import { motion, useMotionValue, useTransform } from "framer-motion";
import { useEffect, useRef, useState } from "react";

const getRelativeCoordinates = (
  event: { pageX: any; pageY: any },
  referenceElement: {
    offsetLeft: any;
    offsetTop: any;
    clientWidth: any;
    clientHeight: any;
    offsetParent: any;
  }
) => {
  const position = {
    x: event.pageX,
    y: event.pageY,
  };

  const offset = {
    left: referenceElement.offsetLeft,
    top: referenceElement.offsetTop,
    width: referenceElement.clientWidth,
    height: referenceElement.clientHeight,
  };

  let reference = referenceElement.offsetParent;

  while (reference) {
    offset.left += reference.offsetLeft;
    offset.top += reference.offsetTop;
    reference = reference.offsetParent;
  }

  return {
    x: position.x - offset.left,
    y: position.y - offset.top,
    width: offset.width,
    centerOffset: position.x - offset.width * 0.26,
  };
};

export const NeonForge = () => {
  const [mousePosition, setMousePosition] = useState<{
    x: number;
    y: number;
    width: number;
    centerOffset: number;
  }>({
    x: 0,
    y: 0,
    width: 0,
    centerOffset: 0,
  });
  const neonForge = useRef();
  const handleMouseMove = (e: { pageX: any; pageY: any }) => {
    if (neonForge.current) {
      setMousePosition(getRelativeCoordinates(e, neonForge.current));
    }
  };

  const centerOffset = useMotionValue(0);

  useEffect(() => {
    centerOffset.set(mousePosition.centerOffset);
  }, [mousePosition]);

  const x = useTransform(centerOffset, (value) => value / 8);

  return (
    <motion.div
      ref={neonForge}
      className="w-full text-transparent relative animated-border [&_svg]:stroke-[1px] [&_svg_path]:animate-[dash_1.5s_cubic-bezier(0.55,0,1,0.45)_0.5s_forwards] [&_svg_path]:[stroke-dasharray:2000] [&_svg_path]:[stroke-dashoffset:2000]"
    >
      <svg
        width="100%"
        viewBox="0 0 1920 1011"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g id="the-neon-forge">
          <g id="the">
            <path
              id="t"
              d="M45.2637 276.986H0V0.239258H376V276.986H328.022V330.239H45.2637V276.986Z"
              fill="currentColor"
            />
            <path
              id="h"
              d="M543.786 276.973H604.634V330.239H762V0.23928L604.634 0.239258V53.3113H543.786V0.23928H386V330.239H543.786V276.973Z"
              fill="currentColor"
            />
            <path
              id="e"
              d="M1144 0.239258H776C773.791 0.239258 772 2.03011 772 4.23925V326.239C772 328.448 773.791 330.239 776 330.239H1144C1146.21 330.239 1148 328.448 1148 326.239V224.673C1148 222.466 1146.21 220.676 1144.01 220.673L979.309 220.439C977.102 220.436 975.315 218.646 975.315 216.439V206.634C975.315 204.425 977.106 202.634 979.315 202.634L1068.55 202.634C1070.76 202.634 1072.55 200.843 1072.55 198.634V133.089C1072.55 130.879 1070.76 129.089 1068.55 129.089L979.315 129.089C977.106 129.089 975.315 127.298 975.315 125.089V115.196C975.315 112.986 977.106 111.196 979.315 111.196L1144 111.196C1146.21 111.196 1148 109.405 1148 107.196V4.23926C1148 2.03012 1146.21 0.239258 1144 0.239258Z"
              fill="currentColor"
            />
          </g>
          <g id="neon">
            <path
              id="n"
              d="M189.407 626.314C187.046 623.36 182.283 625.03 182.283 628.811V666.239C182.283 668.448 180.492 670.239 178.283 670.239L4.00018 670.239C1.79097 670.239 7.68923e-05 668.448 0.000171741 666.239L0.0139963 344.239C0.0140911 342.03 1.80492 340.239 4.014 340.239H150.256C151.479 340.239 152.634 340.798 153.393 341.757L186.892 384.087C189.245 387.06 194.028 385.396 194.028 381.605V344.239C194.028 342.03 195.819 340.239 198.028 340.239H372C374.209 340.239 376 342.03 376 344.239V666.239C376 668.448 374.209 670.239 372 670.239L226.443 670.239C225.227 670.239 224.077 669.686 223.318 668.737L189.407 626.314Z"
              fill="currentColor"
            />
            <path
              id="e_2"
              d="M758 340.239H390C387.791 340.239 386 342.03 386 344.239V666.239C386 668.448 387.791 670.239 390 670.239H758C760.209 670.239 762 668.448 762 666.239V564.673C762 562.466 760.213 560.676 758.006 560.673L593.309 560.439C591.102 560.436 589.315 558.646 589.315 556.439V546.634C589.315 544.425 591.106 542.634 593.315 542.634L682.551 542.634C684.76 542.634 686.551 540.843 686.551 538.634V473.089C686.551 470.879 684.76 469.089 682.551 469.089L593.315 469.089C591.106 469.089 589.315 467.298 589.315 465.089V455.196C589.315 452.986 591.106 451.196 593.315 451.196L758 451.196C760.209 451.196 762 449.405 762 447.196V344.239C762 342.03 760.209 340.239 758 340.239Z"
              fill="currentColor"
            />
            <path
              id="o"
              fillRule="evenodd"
              clipRule="evenodd"
              d="M1148 344.239C1148 342.03 1146.21 340.239 1144 340.239H776C773.791 340.239 772 342.03 772 344.239V666.239C772 668.448 773.791 670.239 776 670.239H1144C1146.21 670.239 1148 668.448 1148 666.239V344.239ZM1002.6 473.065C1002.6 470.856 1000.8 469.065 998.595 469.065H921.405C919.195 469.065 917.405 470.856 917.405 473.065V538.624C917.405 540.833 919.195 542.624 921.405 542.624H998.595C1000.8 542.624 1002.6 540.833 1002.6 538.624V473.065Z"
              fill="currentColor"
            />
            <path
              id="n_2"
              d="M1347.41 626.314C1345.05 623.36 1340.28 625.03 1340.28 628.811V666.239C1340.28 668.448 1338.49 670.239 1336.28 670.239L1162 670.239C1159.79 670.239 1158 668.448 1158 666.239L1158.01 344.239C1158.01 342.03 1159.8 340.239 1162.01 340.239H1308.26C1309.48 340.239 1310.63 340.798 1311.39 341.757L1344.89 384.087C1347.24 387.06 1352.03 385.396 1352.03 381.605V344.239C1352.03 342.03 1353.82 340.239 1356.03 340.239H1530C1532.21 340.239 1534 342.03 1534 344.239V666.239C1534 668.448 1532.21 670.239 1530 670.239L1384.44 670.239C1383.23 670.239 1382.08 669.686 1381.32 668.737L1347.41 626.314Z"
              fill="currentColor"
            />
          </g>
          <g id="forge">
            <path
              id="f"
              d="M372 680.318L42.0935 680.318H4C1.79086 680.318 0 682.109 0 684.318V807.757V1006.32C0 1008.53 1.79087 1010.32 4.00001 1010.32H180.465C181.69 1010.32 182.848 1009.76 183.606 1008.79L307.562 851.571C309.63 848.948 307.761 845.095 304.421 845.095H186.405C184.196 845.095 182.405 843.304 182.405 841.095V811.757C182.405 809.548 184.196 807.757 186.405 807.757H372C374.209 807.757 376 805.967 376 803.757V684.318C376 682.109 374.209 680.318 372 680.318Z"
              fill="currentColor"
            />
            <path
              id="o_2"
              fillRule="evenodd"
              clipRule="evenodd"
              d="M762 684.318C762 682.109 760.209 680.318 758 680.318H390C387.791 680.318 386 682.109 386 684.318V1006.32C386 1008.53 387.791 1010.32 390 1010.32H758C760.209 1010.32 762 1008.53 762 1006.32V684.318ZM616.595 813.145C616.595 810.935 614.805 809.145 612.595 809.145H535.405C533.195 809.145 531.405 810.935 531.405 813.145V878.703C531.405 880.912 533.195 882.703 535.405 882.703H612.595C614.805 882.703 616.595 880.912 616.595 878.703V813.145Z"
              fill="currentColor"
            />
            <path
              id="r"
              fillRule="evenodd"
              clipRule="evenodd"
              d="M1147.2 845.777C1147.72 845.085 1148 844.242 1148 843.376V684.318C1148 682.109 1146.23 680.318 1144.02 680.318C1134.12 680.318 1099.56 680.318 978.985 680.318H776C773.791 680.318 772 682.109 772 684.318V1006.32C772 1008.53 773.791 1010.32 776 1010.32L918.576 1010.32H956.175L1139.86 1010.32C1143.18 1010.32 1145.06 1006.5 1143.03 1003.87L1086.84 931.087C1085.74 929.663 1085.73 927.681 1086.81 926.242L1147.2 845.777ZM962.415 880.769C961.657 881.754 960.489 882.332 959.246 882.332C953.213 882.332 934.588 882.332 921.474 882.332C919.265 882.332 917.481 880.541 917.481 878.332V812.842C917.481 810.633 919.25 808.842 921.459 808.842C939.08 808.842 980.604 808.842 998.225 808.842C1000.43 808.842 1002.2 810.633 1002.2 812.842V827.605C1002.2 828.486 1001.91 829.343 1001.38 830.042L962.415 880.769Z"
              fill="currentColor"
            />
            <path
              id="g"
              d="M1303.06 878.753V813.17C1303.06 810.961 1304.85 809.17 1307.06 809.17H1530C1532.21 809.17 1534 807.379 1534 805.17V684.317C1534 682.108 1532.28 680.317 1530.07 680.317H1342.64H1161.98C1159.77 680.317 1158 682.073 1158 684.282V848.616V1006.36C1158 1008.57 1159.72 1010.32 1161.93 1010.32C1183.45 1010.31 1288.73 1010.28 1362.21 1010.32L1405.3 1010.32L1443.1 1010.32H1530C1532.21 1010.32 1534 1008.52 1534 1006.32V850.233C1534 848.024 1532.21 846.233 1530 846.233H1376.71C1375.5 846.233 1374.35 846.782 1373.59 847.726L1346.61 881.26C1345.85 882.204 1344.71 882.753 1343.5 882.753H1307.06C1304.85 882.753 1303.06 880.962 1303.06 878.753Z"
              fill="currentColor"
            />
            <path
              id="e_3"
              d="M1916 680.318H1548C1545.79 680.318 1544 682.109 1544 684.318V1006.32C1544 1008.53 1545.79 1010.32 1548 1010.32H1916C1918.21 1010.32 1920 1008.53 1920 1006.32V904.752C1920 902.545 1918.21 900.755 1916.01 900.752L1751.31 900.518C1749.1 900.515 1747.32 898.725 1747.32 896.518V886.713C1747.32 884.504 1749.11 882.713 1751.32 882.713L1840.55 882.713C1842.76 882.713 1844.55 880.922 1844.55 878.713V813.168C1844.55 810.959 1842.76 809.168 1840.55 809.168L1751.32 809.168C1749.11 809.168 1747.32 807.377 1747.32 805.168V795.275C1747.32 793.066 1749.11 791.275 1751.32 791.275L1916 791.275C1918.21 791.275 1920 789.484 1920 787.275V684.318C1920 682.109 1918.21 680.318 1916 680.318Z"
              fill="currentColor"
            />
          </g>
        </g>
      </svg>
    </motion.div>
  );
};
